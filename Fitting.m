fun      = @(x) ObjectiveFunction(Temp,Cp,GMultiplicity,N_Rot,Vib_Deg,x);
lb       = 100*ones(1,4);
ub       = inf;
x0       = 2000*ones(1,4);
Vib_Temp = simulannealbnd(fun,x0,lb,ub);

function F = ObjectiveFunction(Temp,Cp,GMultiplicity,N_Rot,Vib_Deg,Vib_Temp)
Vib_Temp0=[2662.47,4815.20,2662.47,1095.97;...
           1198.02,5864.56,168.060,1959.21;...
           1645.36,1175.53,4472.39,1925.00;...
           1565.77,5444.02,468.780,1566.29;...
           5986.67,1858.19,630.380,1855.29;...
           8283.98,1265.65,121.600,1262.64;...
           2545.23,7081.10,812.380,1833.22;...
           1521.59,6258.86,559.250,2528.07;...
           255.570,6391.46,726.290,2083.38;...
           2239.40,889.680,334.420,8473.19;...
           744.730,1643.26,1643.36,5939.62;...
           5460.95,2628.84,527.520,1728.16;...
           100.010,2018.53,783.150,3923.85;...
           561.140,2372.85,5805.52,687.090;...
           687.930,687.930,687.930,2270.70;...
           2186.38,942.270,544.160,2186.28;...
           2193.32,2193.32,2179.33,574.330;...
           339.810,2589.41,5234.73,1086.04;...
           2305.41,514.020,5085.16,832.410;...
           3949.47,596.230,1607.25,596.240;...
           1173.32,1173.32,2288.31,4515.13;...
           101.950,3885.39,1001.27,3723.26];
Vib_Deg0=[2,2,2,3;...
          2,2,2,3;...
          1,1,2,2;...
          1,1,2,2;...
          3,3,3,3;...
          3,3,3,3;...
          2,2,2,3;...
          4,4,5,5;...
          4,4,5,5;...
          3,3,3,3;...
          1,1,2,2;...
          3,4,4,4;...
          3,4,4,4;...
          2,2,2,3;...
          2,2,2,3;...
          2,2,2,3;...
          1,1,2,2;...
          3,4,4,4;...
          3,3,3,3;...
          3,3,3,3;...
          1,1,2,2;...
          1,1,2,2];
Vib_Temp = [Vib_Temp0;Vib_Temp];
Vib_Deg  = [Vib_Deg0;Vib_Deg];
Cp_pre   = Harmonic(Vib_Temp,Vib_Deg,GMultiplicity,Temp,N_Rot);

F        = mean((Cp-Cp_pre)./((5+N_Rot)/2+sum(sum(Vib_Deg,2)'.*GMultiplicity,2)));
end

function Cp = Harmonic(Vib_Temp,Vib_Deg,GMultiplicity,Temp,N_Rot)
R=8.314;
for t=1:size(Temp,2)
    Cv=R*GMultiplicity(t,:)*sum(Vib_Deg.*(Vib_Temp./Temp(t)).^2.*(exp(Vib_Temp./Temp(t)))./(1-exp(Vib_Temp./Temp(t))).^2,2);
    Cp(t)=Cv+(N_Rot(t)+5)*R/2;
end
end